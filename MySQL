create table 67109395_60 (DATETIME datetime,GRANULARITYPERIOD int,SOURCERNCID int,SOURCERNCNAME varchar(50),SOURCECELLNAME varchar(100),SOURCECELLID int,TARGETRNCID int,TARGETCELLID int,COUNTER_67183491 int,COUNTER_67183492 int,COUNTER_67183493 int,COUNTER_67183494 int,COUNTER_67189909 int,COUNTER_67189910 int,COUNTER_67189911 int);
INSERT INTO COMPLETE_DATABASE (DATETIME,CELLNAME,COUNTER_001,COUNTER_002) VALUES ('2015-11-10 20:15:00','ABCD','20','20');
select * from complete_database where COUNTER_002>0.5 order by COUNTER_002 DESC;

select * from complete_database;
select * from 67109395_60;
delete from 67109395_60 where SNo>0;
drop table 67109395_60;
select * from 67109395_60 where DATETIME<2015-12-30;

create table NEIGHBOR_TO_BE_DEFINED (SOURCERNCID int,SOURCECELLID int,TARGETRNCID int,TARGETCELLID int,NUMBER_EVENTS int, COUNT_OF_NEIGHBOR int,INSERTDATE date);
select * from NEIGHBOR_TO_BE_DEFINED;

create table NEIGHBOR_DEFINED (SOURCERNCID int,SOURCECELLID int,TARGETRNCID int,TARGETCELLID int,INSERTDATE date);
insert into neighbor_defined(INSERTDATE) values(curdate()-1);
select * from NEIGHBOR_DEFINED LIMIT 10000;
drop table neighbor_defined;
select * from neighbor_defined;
drop table neighbor_to_be_defined;

select * from neighbor_to_be_defined;
delete from neighbor_to_be_defined where SOURCERNCID>0;

INSERT INTO NEIGHBOR_TO_BE_DEFINED 
(SOURCERNCID,SOURCECELLID,TARGETRNCID,TARGETCELLID,NUMBER_EVENTS) 
SELECT 67109395_60.SOURCERNCID,67109395_60.SOURCECELLID,67109395_60.TARGETRNCID,67109395_60.TARGETCELLID,67109395_60.COUNTER_67183491 FROM 67109395_60
    LEFT OUTER JOIN neighbor_defined
    ON  (67109395_60.SOURCERNCID=NEIGHBOR_DEFINED.SOURCERNCID and 67109395_60.SOURCECELLID=NEIGHBOR_DEFINED.SOURCECELLID and neighbor_defined.INSERTDATE=curdate()) and (67109395_60.TARGETRNCID!=NEIGHBOR_DEFINED.TARGETRNCID or 67109395_60.TARGETCELLID!=NEIGHBOR_DEFINED.TARGETCELLID)
    WHERE NEIGHBOR_DEFINED.SOURCERNCID IS NULL;

delete from neighbor_defined where SOURCERNCID>0;
select * from 67109395_60;
delete from 67109395_60 where SOURCERNCID>0;

create table z1 (SOURCERNCID int, SOURCECELLID int, COUNT_OF_NEIGHBOR int);
drop table z1;
insert into z1(SOURCERNCID,SOURCECELLID,COUNT_OF_NEIGHBOR) select NEIGHBOR_DEFINED.SOURCERNCID,NEIGHBOR_DEFINED.SOURCECELLID , count(NEIGHBOR_DEFINED.SOURCECELLID) as COUNT_OF_NEIGHBOR from NEIGHBOR_DEFINED group by NEIGHBOR_DEFINED.SOURCECELLID;
select * from z1 limit 10000;
select * from neighbor_defined;
select * from neighbor_to_be_defined limit 10000;
update neighbor_to_be_defined set neighbor_to_be_defined.COUNT_OF_NEIGHBOR=(select z1.COUNT_OF_NEIGHBOR from  z1 where ( (neighbor_to_be_defined.SOURCERNCID=z1.SOURCERNCID and neighbor_to_be_defined.SOURCECELLID=z1.SOURCECELLID)));

update neighbor_to_be_defined set neighbor_to_be_defined.COUNT_OF_NEIGHBOR=0;

select * from neighbor_to_be_defined where NUMBER_EVENTS > 2000 order  by NUMBER_EVENTS DESC;

create table action_tracker (SOURCERNCID INT, SOURCECELLID INT, TARGETRNCID INT, TARGETCELLID INT, ACTION_DETAILS VARCHAR(100), ACTION_DATETIME DATETIME);
